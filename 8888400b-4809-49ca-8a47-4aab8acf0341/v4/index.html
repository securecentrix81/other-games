<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Clone</title>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div id="game-container">
      <div id="crosshair"></div>
      <div id="hotbar"></div>
      <div id="health-bar"></div>
      <div id="hud">
        <div id="position">XYZ: 0 / 0 / 0</div>
        <div id="fps">FPS: 0</div>
        <div id="chunk-info">Chunks: 0</div>
        <div id="world-info">World: -</div>
      </div>
      <div id="gamemode-indicator" class="survival">Survival</div>
      <div id="autosave-indicator">üíæ Saving...</div>
      <div id="break-indicator"><div id="break-indicator-inner"></div></div>
      <div id="break-progress-bar"><div id="break-progress-fill"></div></div>

      <div id="menu">
        <h1>‚õè MINECRAFT</h1>
        <p class="subtitle">A Voxel Sandbox Adventure</p>

        <h3 style="color: #fff; margin-bottom: 10px;">Select World</h3>
        <div class="world-slots" id="world-slots"></div>

        <div class="new-world-form" id="new-world-form">
          <label for="world-name">World Name:</label>
          <input type="text" id="world-name" placeholder="My World" maxlength="20">
          <label for="world-seed">Seed (optional):</label>
          <input type="text" id="world-seed" placeholder="Leave empty for random">
          <div class="form-buttons">
            <button id="create-world-btn">Create World</button>
            <button id="cancel-new-world-btn" class="secondary">Cancel</button>
          </div>
        </div>

        <button id="start-btn">Play Selected World</button>
        <button id="new-world-btn" class="secondary">New World</button>
        
        <div class="file-buttons">
          <button id="export-btn" class="secondary">üì§ Export World</button>
          <button id="import-btn" class="secondary">üì• Import World</button>
          <input type="file" id="file-import" accept=".json">
        </div>
        
        <button id="settings-btn" class="secondary">‚öô Settings</button>
      </div>

      <div id="settings-panel">
        <h2>‚öô Settings</h2>
        <div class="settings-container">
          <div class="setting-row">
            <label>Render Distance</label>
            <input type="range" id="setting-render-distance" min="1" max="20" value="6">
            <span class="setting-value" id="render-distance-value">6</span>
          </div>
          <div class="setting-row">
            <label>Shadows Enabled</label>
            <input type="checkbox" id="setting-shadows">
          </div>
          <div class="setting-row" id="shadow-distance-row" style="display:none">
            <label>Shadow Resolution</label>
            <input type="range" id="setting-shadow-distance" min="25" max="100" step="1" value="50">
            <span class="setting-value" id="shadow-distance-value">50</span>
          </div>
          <div class="setting-row" id="shadow-resolution-row" style="display:none">
            <label>Shadow Range</label>
            <input type="range" id="setting-shadow-resolution" min="8" max="14" step="1" value="12">
            <span class="setting-value" id="shadow-resolution-value">4096</span>
          </div>
          <div class="setting-row">
            <label>FOV</label>
            <input type="range" id="setting-fov" min="60" max="120" value="80">
            <span class="setting-value" id="fov-value">80</span>
          </div>
          <div class="setting-row">
            <label>Mouse Sensitivity</label>
            <input type="range" id="setting-sensitivity" min="0.5" max="3" step="0.1" value="1">
            <span class="setting-value" id="sensitivity-value">1.0</span>
          </div>
          <div class="setting-row">
            <label>Autosave (30s)</label>
            <input type="checkbox" id="setting-autosave" checked>
          </div>
          <div class="setting-row">
            <label>Fullscreen</label>
            <input type="checkbox" id="setting-fullscreen">
          </div>
        </div>
        <button id="settings-close-btn">Done</button>
      </div>

      <div id="inventory-screen">
        <h2>Inventory</h2>
        <div class="inventory-container">
          <div class="inventory-section">
            <h3>Inventory</h3>
            <div class="inventory-grid" id="main-inventory"></div>
          </div>
          <div class="inventory-section">
            <h3>Hotbar</h3>
            <div class="inventory-grid" id="hotbar-inventory"></div>
          </div>
        </div>
        <div id="crafting-section">
          <h3>Crafting</h3>
          <div class="recipe-list" id="recipe-list"></div>
        </div>
      </div>

      <div id="death-screen">
        <h1>You Died!</h1>
        <p style="color:#ddd;margin-bottom:20px;">Fell from a high place</p>
        <button id="respawn-btn">Respawn</button>
      </div>

      <div id="loading">
        <div class="spinner"></div>
        <span id="loading-text">Generating World...</span>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js" crossorigin="anonymous"></script>
    <script src="js/constants.js"></script>
    <script src="js/noise.js"></script>
    <script src="js/save-manager.js"></script>
    <script src="js/game.js"></script>
    <script>
      let HAS_ERROR_ALERTED = true;
      addEventListener("error", (e) => {
        if (HAS_ERROR_ALERTED) { HAS_ERROR_ALERTED = false; alert(e.message); }
      });
      
      // Start the game
      const game = new MinecraftGame();
    </script>
  </body>
</html>
